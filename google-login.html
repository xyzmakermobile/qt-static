<!DOCTYPE html>
<html>

<head>
  <title>Google Login for QT</title>
  <meta charset="UTF-8">
</head>

<body>
  <script src="https://apis.google.com/js/platform.js?onload=init" async defer></script>
  <script>
    function init() {
			console.log('init()');
			gapi.load('client:auth2', {
				callback: function() {
					// Initialize client library
					// clientId & scope is provided => automatically initializes auth2 library
					gapi.client.init({
							apiKey: 'V6HMWqkXpxEKVe5uFCRpa9at',
							client_id: '278654058843-3odoh27jg4shvajnjub447prahq8h0tu.apps.googleusercontent.com',
							scope: 'https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/plus.me'
					}).then(
					);
				},
				onerror: function() {
					// Failed to load libraries
				}
			});
			
			checkLogin();
    }
	  
		function checkLogin(){
			var googleuser = gapi.auth2.getAuthInstance().currentUser.get()
			if(googleuser.isSignedIn()){
				console.log('isSignedIn() true');
				getUserInfo(googleuser);
			}else{
				console.log('isSignedIn() false');
			}
		}
	  
    function getUserInfo(googleuser) {
			console.log('getUserInfo()');
			var profile = googleuser.getBasicProfile();
			console.log('ID: ' + profile.getId()); // Do not send to your backend! Use an ID token instead.
			console.log('Name: ' + profile.getName());
			console.log('Image URL: ' + profile.getImageUrl());
			console.log('Email: ' + profile.getEmail()); // This is null if the 'email' scope is not present.

			url = "https://xyzmakermobile.github.io/qt-static/google-info.html?email=" + profile.getEmail() + "&name=" + profile.getName() + "&token=" + googleuser.getAuthResponse().access_token;
			setTimeout("location.href=url", 0);  
    }
  </script>

</body>

</html>
